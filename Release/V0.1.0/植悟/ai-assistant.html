[file name]: ai-assistant.html
[file content begin]
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>植悟 - AI养护助手</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2E7D32', // 深绿色主色调，贴近原型
                        secondary: '#81C784', // 浅绿色辅助色
                        neutral: '#F1F8E9', // 浅背景色
                        dark: '#1B5E20', // 深色文字
                    }
                }
            }
        }
    </script>
    <style>
        /* 对话气泡样式 */
        .chat-bubble-ai {
            background-color: #FFFFFF;
            border: 1px solid #E8F5E9;
            border-radius: 18px 18px 18px 0;
            padding: 12px 16px;
            max-width: 80%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .chat-bubble-user {
            background-color: #81C784;
            color: #FFFFFF;
            border-radius: 18px 18px 0 18px;
            padding: 12px 16px;
            max-width: 80%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #F1F8E9;
        }
        ::-webkit-scrollbar-thumb {
            background: #C8E6C9;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #81C784;
        }
    </style>
</head>
<body class="bg-neutral bg-leaf-pattern min-h-screen">
    <!-- 顶部导航 -->
    <nav class="bg-primary text-white shadow-md fixed top-0 left-0 right-0 z-10">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="index.html" class="hover:text-secondary transition-colors">
                <i class="bi bi-arrow-left text-xl"></i>
            </a>
            <h1 class="text-xl font-bold flex items-center">
                <i class="bi bi-leaf mr-2"></i> 植物养护助手
            </h1>
            <div class="w-8"></div> <!-- 占位，保持导航对称 -->
        </div>
    </nav>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 pt-20 pb-24 flex flex-col md:flex-row gap-6">
        <!-- 左侧：历史对话 + 知识库（电脑端显示，手机端隐藏） -->
        <div class="hidden md:block w-full md:w-64 lg:w-72 shrink-0">
            <!-- 历史对话 -->
            <div class="bg-white rounded-2xl shadow-md p-4 mb-6">
                <h2 class="text-lg font-semibold text-dark mb-4 flex items-center">
                    <i class="bi bi-clock-history text-primary mr-2"></i> 历史对话
                </h2>
                <div class="space-y-3" id="historyConversations">
                    <div class="text-center text-sm text-gray-500 py-4">
                        暂无历史对话
                    </div>
                </div>
            </div>

            <!-- 知识库搜索 -->
            <div class="bg-white rounded-2xl shadow-md p-4">
                <h2 class="text-lg font-semibold text-dark mb-4 flex items-center">
                    <i class="bi bi-book text-primary mr-2"></i> 养护知识库
                </h2>
                <div class="relative mb-4">
                    <input type="text" id="knowledgeSearch" placeholder="搜索养护知识..."
                        class="w-full border border-gray-200 rounded-lg px-3 py-2 pl-10 outline-none focus:border-primary transition-colors">
                    <i class="bi bi-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                </div>
                <div class="space-y-2 max-h-80 overflow-y-auto" id="knowledgeList">
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('多肉浇水指南')">
                        多肉植物浇水指南
                    </div>
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('绿萝养护技巧')">
                        绿萝日常养护与黄叶处理
                    </div>
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('室内植物光照需求')">
                        常见室内植物光照需求表
                    </div>
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('病虫害防治')">
                        植物常见病虫害防治方法
                    </div>
                </div>
            </div>
        </div>

        <!-- 右侧：对话区域（占满剩余宽度） -->
        <div class="w-full flex-1 flex flex-col">
            <!-- 对话内容 -->
            <div class="bg-white rounded-2xl shadow-md flex-1 overflow-hidden flex flex-col">
                <div class="p-4 flex-1 overflow-y-auto" id="chatContent">
                    <!-- 欢迎消息 -->
                    <div class="flex mb-6">
                        <div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                            <i class="bi bi-robot text-primary"></i>
                        </div>
                        <div class="chat-bubble-ai">
                            <p class="text-gray-800">
                                你好呀！我是你的植物养护助手小植～ 有任何养护问题都可以问我哦！比如：
                            </p>
                            <div class="mt-2 flex flex-wrap gap-2">
                                <button class="bg-neutral text-primary text-xs px-2 py-1 rounded-full hover:bg-secondary/20 transition-colors" onclick="sendSampleQuestion('多肉叶子发黄怎么办？')">
                                    多肉叶子发黄怎么办？
                                </button>
                                <button class="bg-neutral text-primary text-xs px-2 py-1 rounded-full hover:bg-secondary/20 transition-colors" onclick="sendSampleQuestion('绿萝多久浇一次水？')">
                                    绿萝多久浇一次水？
                                </button>
                                <button class="bg-neutral text-primary text-xs px-2 py-1 rounded-full hover:bg-secondary/20 transition-colors" onclick="sendSampleQuestion('室内植物需要晒太阳吗？')">
                                    室内植物需要晒太阳吗？
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 底部：图片上传 + 输入框 -->
                <div class="border-t border-gray-100 p-4">
                    <div class="flex items-center mb-3">
                        <button id="uploadImageBtn" class="text-gray-500 hover:text-primary transition-colors p-2">
                            <i class="bi bi-image text-xl"></i>
                        </button>
                        <input type="file" id="imageUpload" accept="image/*" class="hidden">
                        <button id="selectPlantBtn" class="text-gray-500 hover:text-primary transition-colors p-2 ml-1">
                            <i class="bi bi-leaf text-xl"></i>
                        </button>
                        <div class="ml-auto">
                            <button id="clearChatBtn" class="text-gray-500 hover:text-red-500 transition-colors text-sm">
                                新建对话
                            </button>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="chatInput" placeholder="输入你的问题..."
                            class="flex-1 border border-gray-200 rounded-lg px-3 py-2 outline-none focus:border-primary transition-colors">
                        <button id="sendBtn" class="bg-primary text-white rounded-lg px-4 hover:bg-dark transition-colors">
                            发送
                        </button>
                    </div>
                </div>
            </div>

            <!-- 手机端：底部切换栏（电脑端隐藏） -->
            <div class="md:hidden flex bg-white rounded-2xl shadow-md mt-4">
                <button class="flex-1 py-3 text-center text-primary border-b-2 border-primary font-medium" id="mobileChatTab">
                    对话
                </button>
                <button class="flex-1 py-3 text-center text-gray-500 font-medium" id="mobileKnowledgeTab">
                    知识库
                </button>
            </div>

            <!-- 手机端知识库（默认隐藏） -->
            <div class="md:hidden bg-white rounded-2xl shadow-md p-4 mt-4 hidden" id="mobileKnowledgePanel">
                <div class="relative mb-4">
                    <input type="text" id="mobileKnowledgeSearch" placeholder="搜索养护知识..."
                        class="w-full border border-gray-200 rounded-lg px-3 py-2 pl-10 outline-none focus:border-primary transition-colors">
                    <i class="bi bi-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                </div>
                <div class="space-y-2 max-h-60 overflow-y-auto" id="mobileKnowledgeList">
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('多肉浇水指南')">
                        多肉植物浇水指南
                    </div>
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('绿萝养护技巧')">
                        绿萝日常养护与黄叶处理
                    </div>
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('室内植物光照需求')">
                        常见室内植物光照需求表
                    </div>
                    <div class="p-3 bg-neutral rounded-lg text-sm text-gray-600 cursor-pointer hover:bg-secondary/20 transition-colors" onclick="showKnowledgeDetail('病虫害防治')">
                        植物常见病虫害防治方法
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 知识库详情弹窗 -->
    <div class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 hidden" id="knowledgeModal">
        <div class="w-full max-w-md bg-white rounded-2xl shadow-xl p-6 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-dark" id="knowledgeTitle">知识库详情</h2>
                <button onclick="hideKnowledgeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="text-gray-700 space-y-3" id="knowledgeContent">
                <!-- 内容将通过JS动态填充 -->
            </div>
            <button class="w-full mt-6 bg-primary/10 text-primary py-2 rounded-lg hover:bg-primary/20 transition-colors" onclick="hideKnowledgeModal()">
                关闭
            </button>
        </div>
    </div>

    <script>
        // 全局变量：当前会话ID
        let currentConversationId = '';

        // 页面加载初始化
        window.addEventListener('load', () => {
            // 加载历史对话
            loadHistoryConversations();

            // 绑定事件
            bindEvents();

            // 手机端切换栏事件
            document.getElementById('mobileChatTab').addEventListener('click', () => {
                document.getElementById('mobileChatTab').classList.add('text-primary', 'border-b-2', 'border-primary');
                document.getElementById('mobileChatTab').classList.remove('text-gray-500');
                document.getElementById('mobileKnowledgeTab').classList.add('text-gray-500');
                document.getElementById('mobileKnowledgeTab').classList.remove('text-primary', 'border-b-2', 'border-primary');
                document.getElementById('mobileKnowledgePanel').classList.add('hidden');
            });

            document.getElementById('mobileKnowledgeTab').addEventListener('click', () => {
                document.getElementById('mobileKnowledgeTab').classList.add('text-primary', 'border-b-2', 'border-primary');
                document.getElementById('mobileKnowledgeTab').classList.remove('text-gray-500');
                document.getElementById('mobileChatTab').classList.add('text-gray-500');
                document.getElementById('mobileChatTab').classList.remove('text-primary', 'border-b-2', 'border-primary');
                document.getElementById('mobileKnowledgePanel').classList.remove('hidden');
            });

            // 知识库搜索（手机端）
            document.getElementById('mobileKnowledgeSearch').addEventListener('input', (e) => {
                filterKnowledgeList(e.target.value, 'mobileKnowledgeList');
            });

            // 知识库搜索（电脑端）
            document.getElementById('knowledgeSearch').addEventListener('input', (e) => {
                filterKnowledgeList(e.target.value, 'knowledgeList');
            });
        });

        // 绑定所有事件
        function bindEvents() {
            // 发送消息
            document.getElementById('sendBtn').addEventListener('click', sendMessage);
            document.getElementById('chatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });

            // 上传图片
            document.getElementById('uploadImageBtn').addEventListener('click', () => {
                document.getElementById('imageUpload').click();
            });

            document.getElementById('imageUpload').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;

                // 模拟图片上传，生成临时URL
                const reader = new FileReader();
                reader.onload = (res) => {
                    // 添加图片消息到对话
                    addMessageToChat('image', res.target.result);

                    // 模拟AI回复
                    setTimeout(() => {
                        const reply = '我看到你上传的图片啦～ 从图片来看，植物叶片状态良好，但可能有点缺水哦！建议根据植物品种适量浇水，避免积水～';
                        addMessageToChat('ai', reply);
                        saveConversation(reply);
                    }, 1500);
                };
                reader.readAsDataURL(file);
            });

            // 选择植物（关联咨询）
            document.getElementById('selectPlantBtn').addEventListener('click', () => {
                const plants = getPlants();
                if (plants.length === 0) {
                    alert('你还没有添加植物，快去添加植物档案吧～');
                    return;
                }

                let plantOptions = '请选择要咨询的植物：\n';
                plants.forEach((plant, idx) => {
                    plantOptions += `${idx + 1}. ${plant.nickname}（${plant.species}）\n`;
                });

                const selectedIdx = prompt(plantOptions);
                if (!selectedIdx || isNaN(selectedIdx) || selectedIdx < 1 || selectedIdx > plants.length) {
                    return;
                }

                const selectedPlant = plants[selectedIdx - 1];
                document.getElementById('chatInput').value = `我想咨询${selectedPlant.nickname}（${selectedPlant.species}）的养护问题：`;
                document.getElementById('chatInput').focus();
            });

            // 清空对话
            document.getElementById('clearChatBtn').addEventListener('click', () => {
                if (confirm('确定新建对话吗？')) {
                    document.getElementById('chatContent').innerHTML = '';
                    // 重新添加欢迎消息
                    const welcomeMsg = `
                        <div class="flex mb-6">
                            <div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="bi bi-robot text-primary"></i>
                            </div>
                            <div class="chat-bubble-ai">
                                <p class="text-gray-800">
                                    你好呀！我是你的植物养护助手小植～ 有任何养护问题都可以问我哦！比如：
                                </p>
                                <div class="mt-2 flex flex-wrap gap-2">
                                    <button class="bg-neutral text-primary text-xs px-2 py-1 rounded-full hover:bg-secondary/20 transition-colors" onclick="sendSampleQuestion('多肉叶子发黄怎么办？')">
                                        多肉叶子发黄怎么办？
                                    </button>
                                    <button class="bg-neutral text-primary text-xs px-2 py-1 rounded-full hover:bg-secondary/20 transition-colors" onclick="sendSampleQuestion('绿萝多久浇一次水？')">
                                        绿萝多久浇一次水？
                                    </button>
                                    <button class="bg-neutral text-primary text-xs px-2 py-1 rounded-full hover:bg-secondary/20 transition-colors" onclick="sendSampleQuestion('室内植物需要晒太阳吗？')">
                                        室内植物需要晒太阳吗？
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    document.getElementById('chatContent').insertAdjacentHTML('beforeend', welcomeMsg);
                    currentConversationId = '';
                }
            });
        }

        // 发送示例问题
        function sendSampleQuestion(question) {
            document.getElementById('chatInput').value = question;
            sendMessage();
        }
        
        // 发送消息
        function sendMessage() {
            const input = document.getElementById('chatInput').value.trim();
            if (!input) return;

            // 添加用户消息到对话
            addMessageToChat('user', input);
            document.getElementById('chatInput').value = '';

            // 生成AI回复
            generateAiReply(input);

            // 保存对话到历史
            saveConversation(input);
        }

        // 添加消息到对话界面
        function addMessageToChat(type, content) {
            const chatContent = document.getElementById('chatContent');
            let msgHtml = '';

            if (type === 'user') {
                msgHtml = `
                    <div class="flex mb-6 justify-end">
                        <div class="chat-bubble-user">
                            <p>${content}</p>
                        </div>
                        <div class="w-10 h-10 bg-secondary/20 rounded-full flex items-center justify-center ml-3 flex-shrink-0">
                            <i class="bi bi-person text-white"></i>
                        </div>
                    </div>
                `;
            } else if (type === 'ai') {
                msgHtml = `
                    <div class="flex mb-6">
                        <div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                            <i class="bi bi-robot text-primary"></i>
                        </div>
                        <div class="chat-bubble-ai">
                            <p class="text-gray-800">${content}</p>
                        </div>
                    </div>
                `;
            } else if (type === 'image') {
                msgHtml = `
                    <div class="flex mb-6 justify-end">
                        <div class="chat-bubble-user">
                            <img src="${content}" alt="用户上传图片" class="w-full rounded-lg">
                        </div>
                        <div class="w-10 h-10 bg-secondary/20 rounded-full flex items-center justify-center ml-3 flex-shrink-0">
                            <i class="bi bi-person text-white"></i>
                        </div>
                    </div>
                `;
            }

            chatContent.insertAdjacentHTML('beforeend', msgHtml);
            // 滚动到底部
            chatContent.scrollTop = chatContent.scrollHeight;
        }

        // 生成AI回复（模拟）
        function generateAiReply(question) {
            let reply = '';

            // 根据问题关键词生成回复
            if (question.includes('多肉') && question.includes('发黄')) {
                reply = '多肉叶子发黄可能有以下原因及解决方案：\n1. 浇水过多：暂停浇水，放在通风处让土壤干燥，避免烂根；\n2. 光照不足：移至散射光充足处（避免暴晒），每天保持2-4小时光照；\n3. 缺肥：生长期（春/秋）可每月施一次稀薄多肉专用肥。\n\n建议先检查土壤干湿情况，再针对性处理～';
            } else if (question.includes('浇水')) {
                if (question.includes('绿萝')) {
                    reply = '绿萝浇水遵循"见干见湿"原则：春/秋3-5天浇一次，夏季2-3天浇一次，冬季7-10天浇一次。浇水时要浇透，直到盆底漏水，避免积水导致烂根～ 可根据室内湿度和光照调整频率。';
                } else if (question.includes('多肉')) {
                    reply = '多肉浇水要"宁干勿湿"：春/秋生长季7-10天一次，夏季15-20天一次（少量浇水），冬季5°C以上10-15天一次，5°C以下断水。浇水时沿盆边浇，避免浇到叶片中心～';
                } else {
                    reply = '不同植物浇水频率不同哦～ 一般遵循"见干见湿"原则（土壤表面干燥后再浇水）。建议告诉我具体植物品种，我会给你精准的浇水建议！';
                }
            } else if (question.includes('光照') || question.includes('晒太阳')) {
                reply = '常见室内植物光照需求：\n1. 多肉、满天星：喜欢充足散射光，每天2-4小时；\n2. 绿萝、龟背竹：耐阴，每天1小时散射光即可；\n3. 发财树、吊兰：适合明亮通风处，避免阳光直射。\n\n可根据植物品种调整摆放位置～';
            } else if (question.includes('黄叶') || question.includes('枯萎')) {
                reply = '植物黄叶/枯萎可能原因：\n1. 浇水不当（过多或过少）；\n2. 光照不足或过强；\n3. 缺肥或施肥过多；\n4. 病虫害。\n\n建议先检查土壤干湿、光照情况，若有病虫害可拍照咨询具体防治方法～';
            } else {
                reply = '感谢你的提问！我已记录你的问题，以下是相关养护建议：\n1. 保持土壤适度湿润，避免积水；\n2. 放置在通风良好、光照适宜的位置；\n3. 定期观察植物状态，及时处理黄叶、病虫害。\n\n如果你能补充植物品种、生长环境等信息，我会给你更精准的解答！';
            }

            // 模拟AI回复延迟
            setTimeout(() => {
                addMessageToChat('ai', reply);
            }, 800);
        }

        // 保存对话到本地存储
        function saveConversation(question) {
            if (!currentConversationId) {
                currentConversationId = Date.now().toString();
            }

            let conversations = JSON.parse(localStorage.getItem('zhiwu_ai_conversations')) || [];
            const existingIdx = conversations.findIndex(c => c.id === currentConversationId);

            if (existingIdx !== -1) {
                conversations[existingIdx].questions.push(question);
            } else {
                conversations.push({
                    id: currentConversationId,
                    title: question.length > 15 ? question.slice(0, 15) + '...' : question,
                    questions: [question],
                    createTime: new Date().toISOString()
                });
            }

            // 只保留最近10条对话
            if (conversations.length > 10) {
                conversations = conversations.slice(-10);
            }

            localStorage.setItem('zhiwu_ai_conversations', JSON.stringify(conversations));
            loadHistoryConversations();
        }

        // 加载历史对话
        function loadHistoryConversations() {
            const conversations = JSON.parse(localStorage.getItem('zhiwu_ai_conversations')) || [];
            const historyContainer = document.getElementById('historyConversations');

            if (conversations.length === 0) {
                historyContainer.innerHTML = '<div class="text-center text-sm text-gray-500 py-4">暂无历史对话</div>';
                return;
            }

            historyContainer.innerHTML = '';
            conversations.forEach(conv => {
                const date = new Date(conv.createTime);
                const dateStr = `${date.getMonth() + 1}月${date.getDate()}日`;

                const convHtml = `
                    <div class="p-3 bg-neutral rounded-lg cursor-pointer hover:bg-secondary/20 transition-colors" onclick="loadConversation('${conv.id}')">
                        <div class="flex justify-between items-start">
                            <h3 class="text-sm font-medium text-dark truncate">${conv.title}</h3>
                            <span class="text-xs text-gray-500">${dateStr}</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1 truncate">${conv.questions[conv.questions.length - 1]}</p>
                    </div>
                `;
                historyContainer.insertAdjacentHTML('beforeend', convHtml);
            });
        }

        // 加载历史对话详情
        function loadConversation(convId) {
            const conversations = JSON.parse(localStorage.getItem('zhiwu_ai_conversations')) || [];
            const conv = conversations.find(c => c.id === convId);
            if (!conv) return;

            // 清空当前对话
            document.getElementById('chatContent').innerHTML = '';
            currentConversationId = convId;

            // 加载对话历史
            conv.questions.forEach(question => {
                addMessageToChat('user', question);
                // 生成对应的AI回复
                setTimeout(() => {
                    let reply = '';
                    if (question.includes('多肉') && question.includes('发黄')) {
                        reply = '多肉叶子发黄可能有以下原因及解决方案：\n1. 浇水过多：暂停浇水，放在通风处让土壤干燥，避免烂根；\n2. 光照不足：移至散射光充足处（避免暴晒），每天保持2-4小时光照；\n3. 缺肥：生长期（春/秋）可每月施一次稀薄多肉专用肥。';
                    } else if (question.includes('浇水')) {
                        reply = '不同植物浇水频率不同哦～ 一般遵循"见干见湿"原则（土壤表面干燥后再浇水）。';
                    } else {
                        reply = '感谢你的提问！相关养护建议已为你提供，如有其他问题可继续问我～';
                    }
                    addMessageToChat('ai', reply);
                }, 500);
            });
        }

        // 筛选知识库列表
        function filterKnowledgeList(keyword, listId) {
            const list = document.getElementById(listId);
            const items = list.querySelectorAll('div');
            keyword = keyword.toLowerCase();

            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                if (text.includes(keyword)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });

            // 检查是否有匹配结果
            const visibleItems = list.querySelectorAll('div:not(.hidden)');
            if (visibleItems.length === 0) {
                list.innerHTML = '<div class="text-center text-sm text-gray-500 py-4">未找到相关知识</div>';
            }
        }

        // 显示知识库详情
        function showKnowledgeDetail(title) {
            const knowledgeModal = document.getElementById('knowledgeModal');
            const knowledgeTitle = document.getElementById('knowledgeTitle');
            const knowledgeContent = document.getElementById('knowledgeContent');

            knowledgeTitle.textContent = title;

            // 根据标题生成详情内容
            let content = '';
            switch (title) {
                case '多肉浇水指南':
                    content = `
                        <p>多肉植物浇水核心原则：<strong>宁干勿湿，浇则浇透</strong></p>
                        <p>1. 浇水频率：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>春/秋（生长季）：7-10天一次</li>
                            <li>夏季：15-20天一次（少量浇水，避免积水）</li>
                            <li>冬季：5°C以上10-15天一次，5°C以下断水</li>
                        </ul>
                        <p>2. 浇水方法：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>沿盆边缓慢浇水，避免浇到叶片中心</li>
                            <li>直到盆底有水流出，确保根系充分吸收水分</li>
                            <li>浇水后放在通风处，加速土壤干燥</li>
                        </ul>
                        <p>3. 判断是否需要浇水：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>手指插入土壤2-3cm，感觉干燥即可浇水</li>
                            <li>底部叶片发软发皱，说明植物缺水</li>
                        </ul>
                    `;
                    break;
                case '绿萝养护技巧':
                    content = `
                        <p>绿萝是非常适合室内养护的观叶植物，养护要点如下：</p>
                        <p>1. 光照：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>适合明亮的散射光环境，避免阳光直射</li>
                            <li>长期光照不足会导致叶片发黄、茎蔓细长</li>
                        </ul>
                        <p>2. 浇水：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>保持土壤湿润但不积水，见干见湿</li>
                            <li>夏季可向叶片喷水增湿，冬季减少浇水</li>
                        </ul>
                        <p>3. 黄叶处理：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>底部老叶黄化属正常现象，及时摘除即可</li>
                            <li>大面积黄叶可能是浇水过多，需停止浇水并通风</li>
                            <li>叶尖发黄可能是空气干燥，可增加环境湿度</li>
                        </ul>
                    `;
                    break;
                case '室内植物光照需求':
                    content = `
                        <p>不同植物对光照的需求差异较大，合理摆放是养护关键：</p>
                        <p>1. 喜光植物（需放在朝南窗台）：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>多肉植物：每天需要4-6小时光照</li>
                            <li>太阳花、茉莉：需要充足直射光</li>
                            <li>月季：每天至少6小时光照</li>
                        </ul>
                        <p>2. 中等光照（可放在朝东或朝西窗台）：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>绿萝、常春藤：适合明亮散射光</li>
                            <li>白掌、红掌：需要适量光照但忌直射</li>
                        </ul>
                        <p>3. 耐阴植物（可放在朝北窗台或室内）：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>龟背竹、虎皮兰：可适应低光照环境</li>
                            <li>一叶兰：几乎可以在完全阴暗的环境中生长</li>
                        </ul>
                    `;
                    break;
                case '病虫害防治':
                    content = `
                        <p>植物常见病虫害及防治方法：</p>
                        <p>1. 蚜虫：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>症状：叶片背面出现绿色或黑色小虫子，叶片卷曲</li>
                            <li>防治：用清水冲洗，或用肥皂水喷洒，严重时使用杀虫剂</li>
                        </ul>
                        <p>2. 红蜘蛛：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>症状：叶片出现黄色小点，背面有蜘蛛网和细小虫子</li>
                            <li>防治：增加空气湿度，用湿布擦拭叶片，或使用杀螨剂</li>
                        </ul>
                        <p>3. 白粉病：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>症状：叶片出现白色粉末状物质，逐渐蔓延</li>
                            <li>防治：及时摘除病叶，保持通风，喷洒多菌灵等杀菌剂</li>
                        </ul>
                        <p>4. 根腐病：</p>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>症状：叶片发黄枯萎，茎基部腐烂</li>
                            <li>防治：减少浇水，更换透气性好的土壤，切除腐烂根系</li>
                        </ul>
                    `;
                    break;
                default:
                    content = '<p>暂无详细内容</p>';
            }

            knowledgeContent.innerHTML = content;
            knowledgeModal.classList.remove('hidden');
        }

        // 隐藏知识库详情弹窗
        function hideKnowledgeModal() {
            document.getElementById('knowledgeModal').classList.add('hidden');
        }

        // 获取用户添加的植物列表（与主应用数据同步）
        function getPlants() {
            return JSON.parse(localStorage.getItem('zhiwu_plants')) || [];
        }
    </script>
</body>
            <!-- 导航栏 -->
            <div class="nav">
                <a href="index.html" class="nav-item"><i class="fas fa-home nav-icon"></i>首页</a>
                <a href="ai-assistant.html" class="nav-item active"><i class="fas fa-comments nav-icon"></i>ai助手</a>
                <a href="diary.html" class="nav-item"><i class="fas fa-seedling nav-icon"></i>植物</a>
                <a href="profile.html" class="nav-item"><i class="fas fa-user nav-icon"></i>我的</a>
            </div>
            
            <style>
                /* 底部导航样式 */
                .nav {
                    display: flex;
                    justify-content: space-around;
                    background-color: white;
                    padding: 10px 0;
                    position: fixed;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    border-top: 1px solid #eee;
                }
                .nav-item {
                    text-decoration: none;
                    color: #666;
                    font-size: 14px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                }
                .nav-item.active {
                    color: #81c784;
                }
                .nav-icon {
                    font-size: 20px;
                    margin-bottom: 5px;
                }
            </style>

    <script>
        // 初始化导航栏状态
        document.addEventListener('DOMContentLoaded', function() {
            // 移除所有导航项的active类
            const navLinks = document.querySelectorAll('.nav a');
            navLinks.forEach(link => {
                link.classList.remove('active');
            });
            
            // 只将当前页面对应的导航项设为活跃状态
            const currentPath = window.location.pathname.split('/').pop();
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });
        });
    </script>
[file content end]